import{S as s,R as o,A as r}from"./index-DbFwXZiH.js";class g{static REFRESH_TOKEN_KEY="refresh";static async login(e,i){const{data:t,error:a}=await s.getClient().auth.signInWithPassword({email:e,password:i});if(a)throw a;return await this._onLoginSuccess(),t}static async logout(){await s.getClient().auth.signOut(),localStorage.removeItem(s.tokenKey),await o.updateAppData(),window.location.href="/"}static async register(e){const i={...e,organization:r.organization},{data:t,error:a}=await s.getClient().functions.invoke("register",{body:i});if(a)throw a;if(t&&t.code!==200)throw new Error(t.message||"Registration failed");return t}static async resetPasswordForEmail(e){const{data:i,error:t}=await s.getClient().functions.invoke("send-reset-password-link",{body:{email:e,organization:r.organization}});if(t)throw t;return i}static async _onLoginSuccess(){await o.updateAppData()}static async changePassword(e,i){const{data:t,error:a}=await s.getClient().rpc("set_user_password_token",{token:e,password:i});if(a)throw a;return t}static isLoggedIn(){return!!s.getClient().auth.getSession()}}export{g as AuthService};
